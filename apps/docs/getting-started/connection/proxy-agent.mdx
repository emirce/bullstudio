---
title: "Proxy Agent"
description: "Connect to Redis instances in private networks using the bullstudio proxy agent"
---

The proxy agent enables bullstudio to connect to Redis instances that aren't publicly accessible, such as those running locally or in private networks.

## How It Works

The proxy agent is a lightweight command-line tool that runs alongside your Redis instance. It:

1. Connects to your local/private Redis instance
2. Reads BullMQ queue and job data
3. Forwards the data to bullstudio via secure WebSocket

<Frame caption="Proxy agent connection architecture">
  <img src="/images/proxy-agent-schema.png" alt="Proxy agent architecture diagram" />
</Frame>

<Info>
  The proxy agent only makes **outbound connections**—no inbound firewall rules or port forwarding required.
</Info>

## Prerequisites

- Node.js 18+ installed (for npx) or Docker
- Network access from the agent to your Redis instance
- Network access from the agent to the internet (outbound only)

## Step 1: Generate an Agent Key

<Steps>
  <Step title="Navigate to SDK Agents">
    Go to your workspace, click **Connections**, then select the **SDK Agents** tab.
  </Step>
  <Step title="Create an agent">
    Click **Add Agent** and enter a descriptive name (e.g., "Local Development", "Staging Server").
  </Step>
  <Step title="Copy the agent key">
    Copy the generated agent key. You'll need this to run the proxy agent.

    <Frame>
      <img src="/images/proxy-agent-created.png" alt="Agent key generated" />
    </Frame>

    <Warning>
      Store your agent key securely. It cannot be retrieved later—you'll need to generate a new one if lost.
    </Warning>
  </Step>
</Steps>

## Step 2: Run the Proxy Agent

<Tabs>
  <Tab title="NPX (Quick Start)">
    Run the proxy agent directly with npx:

    ```bash
    npx @bullstudio/proxy-agent \
      --agent-key YOUR_AGENT_KEY \
      --redis-host localhost \
      --redis-port 6379
    ```

    The agent will start and begin forwarding queue data to bullstudio.
  </Tab>

  <Tab title="Global Install">
    Install the agent globally for repeated use:

    ```bash
    npm install -g @bullstudio/proxy-agent
    ```

    Then run:

    ```bash
    bullstudio-proxy-agent \
      --agent-key YOUR_AGENT_KEY \
      --redis-host localhost \
      --redis-port 6379
    ```
  </Tab>

  <Tab title="Docker">
    Run the proxy agent in a Docker container:

    ```bash
    docker run -d \
      --name bullstudio-agent \
      --restart unless-stopped \
      -e AGENT_KEY=YOUR_AGENT_KEY \
      -e REDIS_HOST=host.docker.internal \
      -e REDIS_PORT=6379 \
      ghcr.io/bullstudio/proxy-agent:latest
    ```

    <Info>
      Use `host.docker.internal` to connect to Redis running on the host machine. For Redis in another container, use Docker networking.
    </Info>
  </Tab>

  <Tab title="Docker Compose">
    Add the proxy agent to your `docker-compose.yml`:

    ```yaml
    services:
      redis:
        image: redis:7-alpine
        ports:
          - "6379:6379"

      bullstudio-agent:
        image: ghcr.io/bullstudio/proxy-agent:latest
        restart: unless-stopped
        environment:
          AGENT_KEY: ${BULLSTUDIO_AGENT_KEY}
          REDIS_HOST: redis
          REDIS_PORT: 6379
        depends_on:
          - redis
    ```

    Create a `.env` file:

    ```bash
    BULLSTUDIO_AGENT_KEY=your_agent_key_here
    ```
  </Tab>
</Tabs>

## Configuration Options

### Command Line Arguments

| Argument | Environment Variable | Description | Default |
|----------|---------------------|-------------|---------|
| `--agent-key` | `AGENT_KEY` | Your bullstudio agent key | Required |
| `--redis-host` | `REDIS_HOST` | Redis hostname | `localhost` |
| `--redis-port` | `REDIS_PORT` | Redis port | `6379` |
| `--redis-password` | `REDIS_PASSWORD` | Redis password | None |
| `--redis-username` | `REDIS_USERNAME` | Redis ACL username | None |
| `--redis-db` | `REDIS_DB` | Redis database number | `0` |
| `--redis-tls` | `REDIS_TLS` | Enable TLS to Redis | `false` |
| `--log-level` | `LOG_LEVEL` | Logging verbosity | `info` |

### View All Options

```bash
npx @bullstudio/proxy-agent --help
```

## Viewing Agent Status

After starting the proxy agent, you can monitor its status in bullstudio:

1. Go to **Connections** > **SDK Agents**
2. Find your agent in the list
3. Check the connection status indicator

<Frame>
  <img src="/images/proxy-agent-status.png" alt="Agent status showing connected" />
</Frame>

| Status | Description |
|--------|-------------|
| **Connected** | Agent is online and forwarding data |
| **Disconnected** | Agent is not running or lost connection |
| **Pending** | Waiting for first connection |

## Common Configurations

### Local Development

```bash
npx @bullstudio/proxy-agent \
  --agent-key YOUR_AGENT_KEY \
  --redis-host localhost \
  --redis-port 6379
```

### Redis with Password

```bash
npx @bullstudio/proxy-agent \
  --agent-key YOUR_AGENT_KEY \
  --redis-host localhost \
  --redis-port 6379 \
  --redis-password your_password
```

### Redis with ACL (Redis 6+)

```bash
npx @bullstudio/proxy-agent \
  --agent-key YOUR_AGENT_KEY \
  --redis-host localhost \
  --redis-port 6379 \
  --redis-username bullstudio \
  --redis-password your_password
```

### Redis with TLS (Private Network)

```bash
npx @bullstudio/proxy-agent \
  --agent-key YOUR_AGENT_KEY \
  --redis-host redis.internal \
  --redis-port 6379 \
  --redis-tls
```

## Running in Production

For production deployments, we recommend:

<Steps>
  <Step title="Use Docker with restart policy">
    ```bash
    docker run -d \
      --name bullstudio-agent \
      --restart unless-stopped \
      -e AGENT_KEY=YOUR_AGENT_KEY \
      -e REDIS_HOST=redis \
      -e REDIS_PORT=6379 \
      ghcr.io/bullstudio/proxy-agent:latest
    ```
  </Step>
  <Step title="Store secrets securely">
    Use environment variables or a secrets manager instead of command-line arguments for sensitive values.
  </Step>
  <Step title="Monitor agent health">
    Check the agent status in bullstudio periodically or set up alerts for disconnection.
  </Step>
</Steps>

## Troubleshooting

<AccordionGroup>
  <Accordion title="Agent won't connect to bullstudio" icon="wifi">
    **Causes:**
    - Invalid or expired agent key
    - Network blocking outbound WebSocket connections
    - Firewall blocking port 443

    **Solutions:**
    - Verify your agent key is correct
    - Ensure outbound HTTPS (443) is allowed
    - Check proxy settings if behind a corporate firewall
  </Accordion>

  <Accordion title="Agent can't connect to Redis" icon="database">
    **Causes:**
    - Incorrect Redis host or port
    - Redis not running
    - Authentication failure

    **Solutions:**
    - Test Redis connection: `redis-cli -h HOST -p PORT ping`
    - Verify Redis is running: `docker ps` or `systemctl status redis`
    - Check password and username are correct
  </Accordion>

  <Accordion title="No queues appearing in bullstudio" icon="inbox">
    **Causes:**
    - Agent connected to wrong Redis database
    - No BullMQ queues created yet
    - Queue prefix mismatch

    **Solutions:**
    - Check the `--redis-db` setting
    - Verify queues exist: `redis-cli keys "bull:*"`
    - Confirm your BullMQ queues use the default prefix
  </Accordion>

  <Accordion title="Agent disconnects frequently" icon="link-slash">
    **Causes:**
    - Unstable network connection
    - Agent process being killed
    - Memory issues

    **Solutions:**
    - Use Docker with `--restart unless-stopped`
    - Check system resources (memory, CPU)
    - Review agent logs for errors
  </Accordion>
</AccordionGroup>

## Security Considerations

- **Agent keys are workspace-scoped** and can be revoked at any time
- **Only outbound connections** are made—no inbound firewall rules needed
- **Data is encrypted** in transit via TLS/WSS
- **Minimal permissions**: The agent only reads queue metadata and job data

<Tip>
  Create separate agents for each environment (development, staging, production) for better isolation and auditability.
</Tip>

## Next Steps

<Columns cols={2}>
  <Card title="Dashboard" icon="chart-line" href="/features/dashboard">
    View your queue metrics and analytics.
  </Card>
  <Card title="Set Up Alerts" icon="bell" href="/guides/setting-up-alerts">
    Configure alerts for queue health issues.
  </Card>
</Columns>
